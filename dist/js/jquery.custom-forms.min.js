!function(t){var e={customSelect:!0,customCheckbox:!0,useMask:!0,keyMapping:!0,validation:!0,errorContainer:"span.error",stepForm:{active:!1,dynamicValidation:!0,slideToTop:!0,stepSelector:".step",nextSelector:".next-step",prevSelector:".prev-step",dynamicHeight:!1,onNextStep:function(t,e,a,o){},onPrevStep:function(t,e,a,o){},onStepValidation:function(t,e,a,o){}},fileUpload:{active:!1,containerSelector:".upload_container",listSelector:".list_of_files",browseSelector:".add_next_file",apiUrl:"",onFileAdded:function(t,e){},onFileDeleted:function(t,e){}},onSubmit:function(t,e){},onInputValidation:function(t,e,a){},onFormValidation:function(t,e){},onInit:function(t){}};t.fn.customForm=function(a){var o,i,n=null,s=0,l=null,r=0,d=0,c=null,u=null,p=!1,f=null,v=null,h=null,m=function(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<7;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},F=function(e){e.wrap('<div class="custom-form-select" style="position: relative;"></div>');var a=e.attr("name"),o=e.find("option"),n=e.parent(),s=t("<input/>").attr("type","hidden").attr("name",a).attr("value",""),l=e.attr("placeholder");void 0===l&&(l="Wybierz");var r=t("<a></a>").attr("href","").append(t("<span></span>").html(l)).append(t("<i></i>").addClass("fa fa-chevron-down")).on("click",function(t){t.preventDefault()}),d=t('<ul style="position: absolute; bottom: 0; top: 100%;"></ul>');if(t.each(o,function(){var e=t(this).attr("value"),a=t(this).html(),o=t("<li></li>").attr("data-value",e).html(a).on("click",y);d.append(o)}),n.append(r).append(d).append(s),n.on("click",S),n.on("mouseleave",U),i.validation){var c=e.attr("data-validation"),u=e.attr("data-validation-error");"undefined"!=c&&(n.attr("data-validation",c),n.addClass("custom-form-validated"),"undefined"!=u&&n.attr("data-validation-error",u),s.on("change",function(e){if(_(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}))}e.remove()},g=function(e){var a=e.attr("data-checkbox-type"),n=e.attr("data-checkbox-group"),s=e.attr("type");if(void 0===a&&(a="normal"),void 0===n&&(n=null),"box"==a){var l,r,d=o.find('label[for="'+e.attr("id")+'"]');if(n){var c=o.find('[data-group="'+n+'"]');0==c.length?(e.wrap('<div class="custom-form-checkbox type-'+s+'" data-group="'+n+'"></div>'),l=e.parent()):l=c,r=n}else e.wrap('<div class="custom-form-checkbox type-'+s+'"></div>'),l=e.parent(),r=e.attr("name");var u=t("<a></a>").addClass("checkbox").attr("href","").attr("data-value",e.val()).html(d.html()).on("click",b),p=t("<input/>").attr("type","hidden").attr("name",r).attr("value","");if(l.append(u),0==l.find('input[type="hidden"]').length&&l.append(p),i.validation){var f=e.attr("data-validation"),v=e.attr("data-validation-error");void 0!==f&&(l.attr("data-validation",f),l.addClass("custom-form-validated"),void 0!==v&&l.attr("data-validation-error",v),p.on("change",function(e){if(_(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}))}e.remove(),d.remove()}else i.validation&&void 0!==(f=e.attr("data-validation"))&&(e.addClass("custom-form-validated"),e.on("change",function(){var e=t(this).attr("name"),a=!0;if(void 0!==e){var n=!1,s=o.find('[name="'+e+'"]');t.each(s,function(){t(this).is(":checked")&&(n=!0)}),a=n}else a=t(this).is(":checked");if(a?(t(this).addClass("validation-ok"),t(this).removeClass("validation-error")):(t(this).removeClass("validation-ok"),t(this).addClass("validation-error")),i.stepForm.active&&i.stepForm.dynamicValidation){var l=t(this).closest(i.stepForm.stepSelector);T(l)}}))},x=function(e){var a=e.attr("data-validation");if(void 0!==a){e.wrap('<div class="input-group custom-form-validated"></div>');var o=e.parent(),n=[];(n=a.split(/\s/)).length>0&&(o.append(t("<span></span>").addClass("input-group-addon").append('<i class="fa fa-check"></i><i class="fa fa-close"></i>')),-1!=t.inArray("phone",n)&&(o.prepend(t("<span></span>").addClass("input-group-addon prefix").html("+48")),i.useMask&&e.mask("999-999-999")),-1!=t.inArray("post",n)&&i.useMask&&e.mask("99-999"),e.on("change, focusout",function(e){if(_(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}),e.on("keyup",function(e){if(_(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}))}},C=function(e){var a=e.attr("data-validation");if(void 0!==a){e.wrap('<div class="input-group custom-form-validated"></div>');var o=e.parent();a.split(/\s/).length>0&&(o.append(t("<span></span>").addClass("input-group-addon").append('<i class="fa fa-check"></i><i class="fa fa-close"></i>')),e.on("change, focusout",function(e){if(E(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}),e.on("keyup",function(e){if(E(e,t(this)),i.stepForm.active&&i.stepForm.dynamicValidation){var a=t(this).closest(i.stepForm.stepSelector);T(a)}}))}},k=function(){l=o.find(i.stepForm.stepSelector),s=l.length,d=100/parseFloat(s),o.addClass("step-form-wrap").css({overflow:"hidden",width:"100%"});var e=t("<div></div>").addClass("step-form").css({width:100*s+"%",display:"block",transform:"translate(0, 0)",transition:"600ms"});l.wrapAll(e),c=o.find(".step-form"),t.each(l,function(){t(this).css({width:d+"%",display:"block",float:"left"})}),o.find(i.stepForm.nextSelector).on("click",w),o.find(i.stepForm.prevSelector).on("click",A)},D=function(){var e=o.find(i.fileUpload.containerSelector),a=e.find(i.fileUpload.listSelector),n=e.find(i.fileUpload.browseSelector);f="fucont-"+m(),v="fuadd-"+m(),h="fulist-"+m(),e.attr("id",f),a.attr("id",h),n.attr("id",v),(u=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:v,container:document.getElementById(f),url:i.fileUpload.apiUrl,flash_swf_url:"/assets/js/Moxie.swf",silverlight_xap_url:"/assets/js/Moxie.xap",filters:{max_file_size:"10mb",mime_types:[{title:"Image files",extensions:"jpg,gif,png"},{title:"Zip files",extensions:"zip"},{title:"Documents",extensions:"pdf"}]},preinit:{Init:function(t,e){console.log("[Init]",e)},UploadFile:function(t,e){console.log("[UploadFile]",e)}},init:{PostInit:function(){console.log("[PostInit]"),document.getElementById(h).innerHTML=""},Browse:function(t){console.log("[Browse]")},Refresh:function(t){console.log("[Refresh]")},StateChanged:function(t){console.log("[StateChanged]",t.state==plupload.STARTED?"STARTED":"STOPPED")},QueueChanged:function(t){console.log("[QueueChanged]")},OptionChanged:function(t,e,a,o){console.log("[OptionChanged]","Option Name: ",e,"Value: ",a,"Old Value: ",o)},BeforeUpload:function(t,e){console.log("[BeforeUpload]","File: ",e)},UploadProgress:function(t,e){console.log("[UploadProgress]","File:",e,"Total:",t.total)},FileFiltered:function(t,e){console.log("[FileFiltered]","File:",e)},FilesAdded:function(t,e){console.log("[FilesAdded]"),plupload.each(e,function(t){document.getElementById(h).innerHTML+='<li id="'+t.id+'"><input type="hidden" value="'+t.name+'" name="files[]" /><span>'+t.name+'</span><button data-id="'+t.id+'" class="remove">usuń</button></li>'}),i.fileUpload.onFileAdded(o,e)},FilesRemoved:function(t,e){console.log("[FilesRemoved]")},FileUploaded:function(t,e,a){console.log("[FileUploaded] File:",e,"Info:",a)},ChunkUploaded:function(t,e,a){console.log("[ChunkUploaded] File:",e,"Info:",a)},UploadComplete:function(t,e){console.log("[UploadComplete]"),p=!0,o.submit()},Destroy:function(t){console.log("[Destroy]")},Error:function(t,e){console.log(e,t)}}})).init(),a.on("click","button.remove",function(e){e.preventDefault();var a=t(this).attr("data-id");u.removeFile(u.getFile(a)),t("#"+a).remove(),i.fileUpload.onFileDeleted(o,u.getFile(a))})},b=function(e){e.preventDefault();var a=t(this).parent(),o=t(this),i=a.find('input[type="hidden"]'),n=a.hasClass("type-checkbox")?"checkbox":"radio",s=o.attr("data-value");if(o.hasClass("checked")){if("checkbox"==n){if(o.removeClass("checked"),""!=(r=i.attr("value"))){var l=(r=r.split(",")).indexOf(s);l>-1&&r.splice(l,1),r=r.join(",")}i.attr("value",r),i.trigger("change")}}else{if("radio"==n&&a.find(".checkbox").removeClass("checked"),o.addClass("checked"),"radio"==n)i.attr("value",s);else{var r=i.attr("value");""!=r?((r=r.split(",")).push(s),r=r.join(",")):r=s,i.attr("value",r)}i.trigger("change")}},y=function(e){e.preventDefault();var a=t(this).attr("data-value"),o=t(this).html(),i=t(this).parent().parent();""!=a?i.addClass("selected"):i.removeClass("selected"),i.find("a").find("span").html(o),i.find('input[type="hidden"]').val(a).trigger("change")},S=function(e){e.preventDefault();var a=t(this).find("ul");if(t(this).hasClass("opened"))a.css({bottom:"0px"}),t(this).removeClass("opened");else{var o=0;a.find("li").each(function(){o+=t(this).outerHeight(!0)}),a.css({bottom:"-"+o+"px"}),t(this).addClass("opened")}},U=function(e){e.preventDefault(),t(this).find("ul").css({bottom:"0px"}),t(this).removeClass("opened")},w=function(e){e.preventDefault();var a=!0,n=t(this).closest(i.stepForm.stepSelector);if(i.validation&&(a=T(n)),a){r++;var s=parseFloat(r)*d;if(i.stepForm.dynamicHeight){var p=o.find('[form-step="'+r+'"]'),f=p.attr("form-height");p.css({height:f}),t.each(l,function(){t(this).attr("form-step")!=r&&t(this).css({height:f})})}c.css({transform:"translate(-"+s+"%, 0)"}),i.stepForm.slideToTop&&t("body").scrollTo(o.offset().top-180,500),i.fileUpload.active&&u.refresh(),i.stepForm.onNextStep(o,n,r-1,r)}},A=function(e){e.preventDefault();var a=t(this).closest(i.stepForm.stepSelector);if(r--,i.stepForm.dynamicHeight){var n=o.find('[form-step="'+r+'"]'),s=n.attr("form-height");n.css({height:s}),t.each(l,function(){t(this).attr("form-step")!=r&&t(this).css({height:s})})}c.css({transform:"translate(-"+parseFloat(r)*d+"%, 0)"}),i.stepForm.slideToTop&&t("body").scrollTo(o.offset().top-180,500),i.stepForm.onPrevStep(o,a,r+1,r)},_=function(e,a){var n=a.closest(".custom-form-validated");0==n.length&&(n=a);var s=a.attr("type");if(-1!=t.inArray(s,["text","hidden","email"])){var l,r=a.val(),d=(l="text"==s||"email"==s?a.attr("data-validation"):n.attr("data-validation")).split(/\s/);if(d.length>0){var c=!0;t.each(d,function(t,e){var a=!0;switch(e){case"required":a=I(r);break;case"phone":a=M(r);break;case"email":a=H(r);break;case"alphanumeric":a=P(r);break;case"post":a=B(r);break;default:a=!0}a||(c=!1)}),c?(n.addClass("validation-ok"),n.removeClass("validation-error")):(n.removeClass("validation-ok"),n.addClass("validation-error")),i.onInputValidation(o,a,c)}}},E=function(e,a){var n=a.closest(".custom-form-validated");0==n.length&&(n=a);var s,l=a.val(),r=(s=a.attr("data-validation")).split(/\s/);if(r.length>0){var d=!0;t.each(r,function(t,e){var a=!0;switch(e){case"required":a=I(l);break;default:a=!0}a||(d=!1)}),d?(n.addClass("validation-ok"),n.removeClass("validation-error")):(n.removeClass("validation-ok"),n.addClass("validation-error")),i.onInputValidation(o,a,d)}},V=function(e){var a=!0;return t.each(e,function(){var e,i=t(this).prop("tagName").toLowerCase();"input"!=i&&"textarea"!=i?0==(e=t(this).find("input")).length&&(e=t(this).find("textarea")):e=t(this);var n,s,l=e.val();"textarea"!=e.prop("tagName").toLowerCase()?n="text"==(s=e.attr("type"))||"email"==s?e.attr("data-validation"):t(this).attr("data-validation"):(s="text",n=e.attr("data-validation"));var r=n.split(/\s/);if(r.length>0){var d=!0;if("checkbox"!=s)t.each(r,function(t,e){var a=!0;switch(e){case"required":a=I(l);break;case"phone":a=M(l);break;case"email":a=H(l);break;case"alphanumeric":a=P(l);break;case"post":a=B(l);break;default:a=!0}a||(d=!1)});else{var c=t(this).attr("name");if(void 0!==c){var u=!1,p=o.find('[name="'+c+'"]');t.each(p,function(){t(this).is(":checked")&&(u=!0)}),d=u}else d=t(this).is(":checked")}d?(t(this).addClass("validation-ok"),t(this).removeClass("validation-error")):(a=!1,t(this).removeClass("validation-ok"),t(this).addClass("validation-error"))}}),a},T=function(t){var e=t.find(".custom-form-validated"),a=V(e);return i.stepForm.onStepValidation(o,t,r,a),a},z=function(){var t=o.find(".custom-form-validated"),e=V(t);return i.onFormValidation(o,e),e},I=function(t){return t.match(/^.+$/)},M=function(t){return""==t||(t=t.replace(/(\-|\s)/gi,""),matches=t.match(/^[0-9]{9}$/),matches)},H=function(t){return""==t||t.match(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/)},P=function(t){return""==t||t.match(/^([A-ZĘÓĄŚŁŻŹĆŃa-zęóąśłżźćń0-9\s\-\/\.]+)$/)},B=function(t){return""==t||(t=t.replace(/(\-|\s)/gi,""),matches=t.match(/^[0-9]{5}$/),matches)};this.length>0&&(this.length>1?this.each(function(){t(this).customForm(a)}):(!function(a){if("boolean"==typeof(i=t.extend({},e,a)).stepForm){var o=i.stepForm;i.stepForm={active:o,dynamicValidation:!0,slideToTop:!0,stepSelector:".step",nextSelector:".next-step",prevSelector:".prev-step",dynamicHeight:!1,onNextStep:function(t,e,a,o){},onPrevStep:function(t,e,a,o){},onStepValidation:function(t,e,a,o){}}}else i.stepForm=t.extend({},e.stepForm,i.stepForm);if("boolean"==typeof i.fileUpload){var n=i.fileUpload;i.fileUpload={active:n,containerSelector:".upload_container",listSelector:".list_of_files",browseSelector:".add_next_file",apiUrl:"",onFileAdded:function(t,e){},onFileDeleted:function(t,e){}}}else i.fileUpload=t.extend({},e.fileUpload,i.fileUpload)}(a),(o=this).addClass("custom-form"),n=o.find("input, select, textarea"),t.each(n,function(){var e=t(this),a=e.prop("tagName").toLowerCase(),o="input"==a?e.attr("type"):"not-needed";i.validation&&(e.removeAttr("required"),e.attr("autocomplete","off")),"select"==a&&i.customSelect&&F(e),"input"!=a||"checkbox"!=o&&"radio"!=o||!i.customCheckbox||g(e),i.validation&&"input"==a&&-1!=t.inArray(o,["text","email"])&&x(e),i.validation&&"textarea"==a&&C(e)}),i.stepForm.active&&k(),i.fileUpload.active&&D(),o.on("submit",function(t){var e=!0;i.validation&&(e=z()),e?i.fileUpload.active&&0==p?(t.preventDefault(),u.start()):i.onSubmit(t,o):(t.preventDefault(),console.log("zle!"))}),i.onInit(),t(window).on("load",function(){var e=o.find(i.stepForm.stepSelector);if(t.each(e,function(){var e=t(this).outerHeight();t(this).attr("form-height",e)}),i.stepForm.dynamicHeight){var a=o.find('[form-step="0"]').attr("form-height");t.each(e,function(){0!=t(this).attr("form-step")&&t(this).css({height:a})})}})))}}(jQuery);